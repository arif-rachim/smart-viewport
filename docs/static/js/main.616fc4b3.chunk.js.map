{"version":3,"sources":["MobileScreen.module.css","MobileScreen.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","DEFAULT_STATE","screen","width","height","reducer","state","action","type","VideoElement","isLandscapeMode","boxPerRow","video","style","viewPortRef","useRef","toFixed","useEffect","current","appendChild","ref","className","classes","viewport","updateAllViewports","document","querySelectorAll","forEach","div","content","viewPort","viewPortWidth","offsetWidth","viewPortHeight","offsetHeight","contentWidth","contentHeight","scaleX","scaleY","scale","Math","max","newContentWidth","newContentHeight","top","left","setAttribute","fillContentInViewPort","firstChild","MobileScren","videos","controllerRef","useReducer","dispatch","screenRef","updateDisplay","onResize","event","window","addEventListener","updateMobileScreenViewPorts","preventDefault","lastTouchEnd","now","Date","getTime","removeEventListener","screenStyle","border","boxSizing","position","display","flexDirection","flexWrap","ratio","numberOfBoxes","length","boxesPerRow","key","toString","calculateBoxPerRow","map","i","createDiv","createElement","innerHTML","App","useState","setVideos","vids","push","right","ButtonGroup","variant","color","aria-label","Button","onClick","filter","vid","idx","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.616fc4b3.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"viewport\":\"MobileScreen_viewport__5NiKG\"};","import React, {useEffect, useReducer, useRef} from \"react\";\r\nimport classes from './MobileScreen.module.css';\r\nconst DEFAULT_STATE = {\r\n    screen : {\r\n        width : 0,\r\n        height : 0\r\n    }\r\n};\r\n\r\nconst reducer = (state,action) => {\r\n    switch (action.type) {\r\n        case 'screen-size' :\r\n            return {...state,screen:{width:action.width,height:action.height}}\r\n        default :\r\n            return state;\r\n    }\r\n};\r\n\r\n\r\nfunction calculateBoxPerRow(numberOfBoxes) {\r\n    const boxesPerRow = {\r\n        '1' : 1,\r\n        '2' : 2,\r\n        '3' : 3,\r\n        '4' : 2,\r\n        '5' : 3,\r\n        '6' : 3,\r\n        '7' : 4,\r\n        '8' : 4,\r\n        '9' : 3,\r\n        '10' : 5,\r\n        '11' : 4,\r\n        '12' : 4,\r\n        '13' : 5,\r\n        '14' : 5,\r\n        '15' : 5,\r\n        '16' : 4,\r\n        '17' : 5,\r\n        '18' : 5\r\n    };\r\n    const key = numberOfBoxes.toString();\r\n    if(key in boxesPerRow){\r\n        return boxesPerRow[key];\r\n    }\r\n    return 5;\r\n}\r\n\r\nfunction fillContentInViewPort(content, viewPort) {\r\n    const {offsetWidth: viewPortWidth, offsetHeight: viewPortHeight} = viewPort;\r\n    const {offsetWidth: contentWidth, offsetHeight: contentHeight} = content;\r\n    if(contentWidth === 0 && contentHeight === 0){\r\n        return;\r\n    }\r\n    const scaleX = viewPortWidth / contentWidth;\r\n    const scaleY = viewPortHeight / contentHeight;\r\n    const scale = Math.max(scaleX,scaleY);\r\n    const newContentWidth = contentWidth * scale;\r\n    const newContentHeight = contentHeight * scale;\r\n    const top = (viewPortHeight - newContentHeight)  / 2;\r\n    const left = (viewPortWidth - newContentWidth) / 2;\r\n\r\n    content.setAttribute('style', `\r\n        width:${newContentWidth}px;\r\n        height:${newContentHeight}px;\r\n        top:${top}px;\r\n        left:${left}px;\r\n        position:absolute;\r\n        transition:all 300ms ease-in-out;\r\n    `);\r\n}\r\n\r\nfunction VideoElement({isLandscapeMode,boxPerRow,video}) {\r\n    const style = {};\r\n    const viewPortRef = useRef();\r\n    style[isLandscapeMode ? 'width' : 'height'] = `${(100 / boxPerRow).toFixed(0)}%`;\r\n    useEffect(() => {\r\n        viewPortRef.current.appendChild(video);\r\n    },[video]);\r\n    return <div ref={viewPortRef} className={classes.viewport} style={style}/>;\r\n}\r\n\r\nfunction updateAllViewports() {\r\n    document.querySelectorAll(`.${classes.viewport}`).forEach((div) => {\r\n        fillContentInViewPort(div.firstChild, div);\r\n    });\r\n}\r\n\r\nexport default function MobileScren({videos,controllerRef}){\r\n    const [state,dispatch] = useReducer(reducer,DEFAULT_STATE);\r\n    const screenRef = useRef();\r\n    controllerRef.current = {\r\n        updateDisplay : updateAllViewports\r\n    };\r\n    useEffect(() => {\r\n        function onResize(event) {\r\n            const {offsetWidth:width,offsetHeight:height} = screenRef.current;\r\n            dispatch({type:'screen-size',width,height});\r\n        }\r\n        onResize();\r\n        window.addEventListener(\"resize\", onResize);\r\n        window.updateMobileScreenViewPorts = () => {\r\n            updateAllViewports();\r\n        };\r\n        // IOS Bug fix\r\n        document.addEventListener('touchmove', function (event) {\r\n            if (event.scale !== 1) { event.preventDefault(); }\r\n        }, false);\r\n        let lastTouchEnd = 0;\r\n        document.addEventListener('touchend', function (event) {\r\n            const now = (new Date()).getTime();\r\n            if (now - lastTouchEnd <= 300) {\r\n                event.preventDefault();\r\n            }\r\n            lastTouchEnd = now;\r\n        }, false);\r\n\r\n        return () => {\r\n            window.removeEventListener('resize',onResize);\r\n        }\r\n    },[]);\r\n    const isLandscapeMode = state.screen.width > state.screen.height;\r\n    const screenStyle = {\r\n        border:'1px solid red',\r\n        height:'100%',\r\n        boxSizing:'border-box',\r\n        position:'relative',\r\n        display : 'flex',\r\n        flexDirection : isLandscapeMode ? 'row' : 'column',\r\n        flexWrap : 'wrap'\r\n    };\r\n    const ratio = state.screen.width / state.screen.height;\r\n    useEffect(() => {\r\n        updateAllViewports();\r\n    },[ratio]);\r\n    const numberOfBoxes = videos.length;\r\n    useEffect(() => {\r\n        updateAllViewports();\r\n    },[numberOfBoxes]);\r\n    const boxPerRow = calculateBoxPerRow(numberOfBoxes);\r\n    return <div ref={screenRef} style={screenStyle}>\r\n        {videos.map((video,i) => <VideoElement key={i} video={video} isLandscapeMode={isLandscapeMode} boxPerRow={boxPerRow}/>)}\r\n    </div>\r\n}\r\n","import React, {useEffect, useRef, useState} from 'react';\r\nimport MobileScreen from \"./MobileScreen\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\r\n\r\nfunction createDiv() {\r\n    const div = document.createElement('div');\r\n    div.innerHTML = `<div style=\"width: 100%;height:100%;display: flex;align-items: center;justify-content: center\">\r\n                <img src=\"pics.jpg\" onload=\"updateMobileScreenViewPorts()\"/>\r\n            </div>`;\r\n    return div;\r\n}\r\n\r\nexport default function App() {\r\n    const [videos,setVideos] = useState([]);\r\n    const screenRef = useRef();\r\n    useEffect(() => {\r\n        const vids = [];\r\n        for (let i = 0; i < 5; i++) {\r\n            vids.push(createDiv());\r\n        }\r\n        setVideos(vids);\r\n    },[]);\r\n\r\n    function handleOnAdd() {\r\n        setVideos((vids) => [...vids,createDiv()]);\r\n    }\r\n\r\n\r\n    function handleOnUpdate(){\r\n        screenRef.current.updateDisplay();\r\n    }\r\n\r\n    function handleOnRemove(){\r\n        setVideos((vids) => {\r\n            return vids.filter((vid,idx) => {\r\n                if(idx === vids.length - 1){\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        });\r\n    }\r\n    return <div style={{width:'100%',height:'100%',position:'relative'}}>\r\n        <MobileScreen videos={videos} controllerRef={screenRef}/>\r\n        <div style={{position:'absolute',top:10,right:10}}>\r\n            <ButtonGroup variant=\"contained\" color=\"primary\" aria-label=\"contained primary button group\">\r\n                <Button onClick={() => handleOnAdd()} variant={\"contained\"}>Add</Button>\r\n                <Button onClick={() => handleOnRemove()} variant={\"contained\"}>Remove</Button>\r\n                <Button onClick={() => handleOnUpdate()}>Update</Button>\r\n            </ButtonGroup>\r\n\r\n        </div>\r\n    </div>\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<React.StrictMode><App /></React.StrictMode>,document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}